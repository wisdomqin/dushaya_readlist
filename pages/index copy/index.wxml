<safe-area-top></safe-area-top>
<view class="page-container" style="{{containerStyle}}">
  <scroll-view 
    scroll-y="true" 
    class="book-list-container" 
    bindscrolltolower="loadMore"
    refresher-enabled="{{true}}"
    refresher-threshold="{{100}}"
    refresher-default-style="black"
    refresher-background="#f5f5f5"
    refresher-triggered="{{isRefreshing}}"
    bindrefresherrefresh="onPullDownRefresh"
  >
    <view wx:if="{{bookLists.length === 0}}" class="no-data">
      <text>暂无书单，快去添加吧！</text>
    </view>
    <view wx:for="{{bookLists}}" wx:key="_id" class="book-card" bindtap="goToDetail" data-id="{{item._id}}">
      <view class="duck-review">
        <text class="review-content">"{{item.review}}"</text>
        <text class="review-title">——读啥鸭评价</text>
      </view>
      <view class="book-info">
        <view class="book-title-grade">
          <text class="book-title">{{item.title}}</text>
          <view class="book-grade-container">
            <view class="grade-image-container">
              <image class="grade-image" src="/images/{{item.grade === '经典' ? 'classic.png' : item.grade === '神书' ? 'god.png' : item.grade === '普通' ? 'simple.png' : item.grade === '有意思' ? 'interesting.png' : 'default.png'}}" mode="aspectFit"></image>
            </view>
            <view class="book-grade">{{item.grade || '无评级'}}</view>
          </view>
        </view>
        <text class="book-author">作者：{{item.author}}</text>
        <view class="book-tags">标签：{{item.tags}}</view>
        <text class="book-description">简介：{{item.description}}</text>
      </view>
      <view class="book-rating" wx:if="{{item.rating > 0}}">
        <text class="rating-score">{{item.rating}}</text>
        <text class="rating-count" wx:if="{{item.ratingCount > 0}}">{{item.ratingCount}}人评分</text>
      </view>
    </view>
  </scroll-view>
  <view class="submit-btn" bindtap="goToSubmit">+</view>
</view>
